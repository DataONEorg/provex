
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/3.3.0pr3/build/cssreset/reset-min.css"> 
	<link rel="stylesheet" type="text/css" href="http://axosoft.github.com/yui3-gallery/layout/build/assets/skins/sam/gallery-axo-layout.css"> 
	<link rel="stylesheet" type="text/css" href="http://axosoft.github.com/yui3-gallery/layout/build/assets/skins/sam/gallery-axo-layout-skin.css"> 

	<script type="text/javascript" src="http://jgraph.github.io/mxgraph/javascript/src/js/mxClient.js"></script>

	<script type="text/javascript" src="http://yui.yahooapis.com/3.3.0pr3/build/yui/yui.js"></script>

	<script type="text/javascript" src="http://axosoft.github.com/yui3-gallery/layout/build/gallery-axo-layout.js"></script>
	
	<script type="text/javascript">
	
	function displayTraceJSON(container, traceJSON) {
		// Checks if the browser is supported
    	if (!mxClient.isBrowserSupported()) {
    		// Displays an error message if the browser is not supported.
    		mxUtils.error('Browser is not supported!', 200, false);
    	}
    	else {
    		
    		container.innerHTML = "";
    		
    		mxEvent.disableContextMenu(document.body);
    		
    		// Enables crisp rendering of rectangles in SVG
    		mxRectangleShape.prototype.crisp = true;
    				
    		// Creates the graph inside the given container
    		var graph = new mxGraph(container);
    		graph.graphHandler.scaleGrid = true;
    		graph.setPanning(true);

    		// Enables rubberband selection
    		new mxRubberband(graph);
    		
    		// Gets the default parent for inserting new cells. This
    		// is normally the first child of the root (ie. layer 0).
    		var parent = graph.getDefaultParent();
    								
    		// Adds cells to the model in a single step
    		graph.getModel().beginUpdate();
    		try {
    			
    			var traceNodesArray = new Array();
    			var traceEdgesArray = new Array();
    			
    			fillTrace(traceJSON, graph, parent, traceNodesArray, traceEdgesArray);
    			
    			var layout = new mxHierarchicalLayout(graph);
    			layout.execute(parent);
    			
    		}
    		finally {
    			// Updates the display
    			graph.getModel().endUpdate();
    		}

    		graph.centerZoom = false;
    		
    		var bounds = graph.getGraphBounds();
    		graph.view.setTranslate( (container.clientWidth/2) - (bounds.width/2), 
    				(container.clientHeight/2) - (bounds.height/2) );
    		
    	}
    }
    
    
    function fillTrace(traceJSON, graph, parent, traceNodesArray, traceEdgesArray) {
    	var vertex = null;
    	var edge = null;
    	var tuple = null;
    	for(var i = 0; i < traceJSON.nodes.length; i++) {
    		tuple = traceJSON.nodes[i];
    		if( traceNodesArray[tuple.nodeId] == undefined ) {
    			if(tuple.nodeType == "d")
    				vertex = graph.insertVertex(parent, null, tuple.nodeId, 0, 0, 80, 30, "shape=ellipse");
    			else
    				vertex = graph.insertVertex(parent, null, tuple.nodeId, 0, 0, 80, 30);
    			traceNodesArray[tuple.nodeId] = vertex;
			}
		}
    	for(var i = 0; i < traceJSON.edges.length; i++) {
    		tuple = traceJSON.edges[i];
    		edge = graph.insertEdge(parent, null, tuple.edgeLabel, traceNodesArray[tuple.startNodeId], 
    				traceNodesArray[tuple.endNodeId]);
    		traceEdgesArray[tuple.startNodeId + "_" + tuple.endNodeId] = edge;
		}
    }
    
    </script>

    <title>Axosoft Layout Example</title>

	<style>

	.yui3-skin-sam .yui3-layout-vertical > .yui3-layout-content {
		border:2px solid black;
		padding:1px;
	}

	.yui3-skin-sam .yui3-layoutchild {
		opacity:0.8;
		border:1px solid black;
	}

	#left {
		background:white;
	}

	#right {
		background:white;
	}

	#top {
		background:blue;
		opacity:0.6;
	}

	#bottom {
		background:yellow;
		opacity:0.6;
	}

	#center1 {
		background:white;
		overflow:scroll;
	}
	
	#center2 {
		background:white;
	}

	#bottom .yui3-layoutchild {
		background:white;
		border:1px solid black;
	}

	#bottom1 {
		opacity:0.1;
	}
	
	#wfContainer {
		
	}

	.yui3-layoutchild-content .yui3-widget-hd {
		background: white;
		color: black;
		border:solid black 1px;
		padding-left:5px;
		height:23px;
	}

	.yui3-layoutChild-button-collapse, .yui3-layoutChild-button-expand {
		width: 17px;
		height: 13px;
		right:5px;
		top:5px;
		position: absolute;
		background: transparent url(http://developer.yahoo.com/yui/build/layout/assets/skins/sam/layout_sprite.png) no-repeat;
	}

	#left .yui3-layoutChild-button-collapse {
		background-position: -20px -160px;
	} 

	#left .yui3-layoutChild-button-expand {
		background-position: -20px -140px;
	} 
	
	#center1 .yui3-layoutChild-button-collapse {
		background-position: -20px -160px;
	} 

	#center1 .yui3-layoutChild-button-expand {
		background-position: -20px -140px;
	}

	#right .yui3-layoutChild-button-collapse {
		background-position: -20px -200px;
	} 

	#right .yui3-layoutChild-button-expand {
		background-position: -20px -120px;
	} 
	
	#center1 > .yui3-widget-content-expanded {
		height: 25px;
	}

	</style>

</head>

<body class="yui3-skin-sam">

<script>

YUI().use('gallery-axo-layout', 'resize', function(Y)
{

	var layout = new Y.Layout({orientation: 'vertical', sizeToWindow: true });

	layout.add(new Y.LayoutChild({id:'top', height:80, resize: true }));

	var centerLayout = new Y.Layout({fluid: true, orientation: 'horizontal' });
	layout.add(centerLayout);

	var bottomLayout = new Y.Layout({id:'bottom', height:80, orientation: 'horizontal', resize: true });
	layout.add(bottomLayout);
	
	centerLayout.add(new Y.LayoutChildStd({id: 'left', width:150, resize: true, label: 'left'}));
	centerLayout.add(new Y.LayoutChildStd({id: 'center1', width:550, resize: true, label: 'center1'}));
	centerLayout.add(new Y.LayoutChildStd({id: 'center2', fluid: true, label: 'center2'}));
	centerLayout.add(new Y.LayoutChildStd({id: 'right', width:100, resize: true, label: 'right'}));

	bottomLayout.add(new Y.LayoutChild({id: 'bottom1'}));

	layout.render();
});

YUI().use('node', function (Y) {
	var center1 = Y.one('#center1');
	var wfContainerHTML = '<div id="wfContainer"></div>';
	center1.get('children').slice(-1).item(0).insert(wfContainerHTML, 'after');
});

YUI().use('node', 'json-parse', function (Y) {
	var traceJSONStr = '{"edges":[{"endNodeId":"p0","edgeLabel":"u","startNodeId":"a0"},{"endNodeId":"p0","edgeLabel":"u","startNodeId":"a1"},{"endNodeId":"p1","edgeLabel":"u","startNodeId":"a3"},{"endNodeId":"p1","edgeLabel":"u","startNodeId":"a4"},{"endNodeId":"p1","edgeLabel":"u","startNodeId":"a5"},{"endNodeId":"p1","edgeLabel":"u","startNodeId":"a6"},{"endNodeId":"p1","edgeLabel":"u","startNodeId":"a2"},{"endNodeId":"p2","edgeLabel":"u","startNodeId":"a8"},{"endNodeId":"p2","edgeLabel":"u","startNodeId":"a7"},{"endNodeId":"p3","edgeLabel":"u","startNodeId":"a10"},{"endNodeId":"p3","edgeLabel":"u","startNodeId":"a11"},{"endNodeId":"p4","edgeLabel":"u","startNodeId":"a13"},{"endNodeId":"p4","edgeLabel":"u","startNodeId":"a14"},{"endNodeId":"p4","edgeLabel":"u","startNodeId":"a15"},{"endNodeId":"p4","edgeLabel":"u","startNodeId":"a16"},{"endNodeId":"p4","edgeLabel":"u","startNodeId":"a12"},{"endNodeId":"p5","edgeLabel":"u","startNodeId":"a18"},{"endNodeId":"p5","edgeLabel":"u","startNodeId":"a17"},{"endNodeId":"p6","edgeLabel":"u","startNodeId":"a20"},{"endNodeId":"p6","edgeLabel":"u","startNodeId":"a9"},{"endNodeId":"p6","edgeLabel":"u","startNodeId":"a19"},{"endNodeId":"p7","edgeLabel":"u","startNodeId":"a21"},{"endNodeId":"p8","edgeLabel":"u","startNodeId":"a22"},{"endNodeId":"p8","edgeLabel":"u","startNodeId":"a23"},{"endNodeId":"p8","edgeLabel":"u","startNodeId":"a19"},{"endNodeId":"p9","edgeLabel":"u","startNodeId":"a25"},{"endNodeId":"p9","edgeLabel":"u","startNodeId":"a26"},{"endNodeId":"p9","edgeLabel":"u","startNodeId":"a9"},{"endNodeId":"p9","edgeLabel":"u","startNodeId":"a19"},{"endNodeId":"p10","edgeLabel":"u","startNodeId":"a28"},{"endNodeId":"p10","edgeLabel":"u","startNodeId":"a29"},{"endNodeId":"p10","edgeLabel":"u","startNodeId":"a9"},{"endNodeId":"p10","edgeLabel":"u","startNodeId":"a19"},{"endNodeId":"p11","edgeLabel":"u","startNodeId":"a31"},{"endNodeId":"p11","edgeLabel":"u","startNodeId":"a24"},{"endNodeId":"p11","edgeLabel":"u","startNodeId":"a27"},{"endNodeId":"p11","edgeLabel":"u","startNodeId":"a30"},{"endNodeId":"p12","edgeLabel":"u","startNodeId":"a33"},{"endNodeId":"p12","edgeLabel":"u","startNodeId":"a34"},{"endNodeId":"p13","edgeLabel":"u","startNodeId":"a32"},{"endNodeId":"p13","edgeLabel":"u","startNodeId":"a35"},{"endNodeId":"p14","edgeLabel":"u","startNodeId":"a36"},{"endNodeId":"p14","edgeLabel":"u","startNodeId":"a37"},{"endNodeId":"p14","edgeLabel":"u","startNodeId":"a21"},{"endNodeId":"a2","edgeLabel":"g","startNodeId":"p0"},{"endNodeId":"a7","edgeLabel":"g","startNodeId":"p1"},{"endNodeId":"a9","edgeLabel":"g","startNodeId":"p2"},{"endNodeId":"a12","edgeLabel":"g","startNodeId":"p3"},{"endNodeId":"a17","edgeLabel":"g","startNodeId":"p4"},{"endNodeId":"a19","edgeLabel":"g","startNodeId":"p5"},{"endNodeId":"a21","edgeLabel":"g","startNodeId":"p6"},{"endNodeId":"a24","edgeLabel":"g","startNodeId":"p8"},{"endNodeId":"a27","edgeLabel":"g","startNodeId":"p9"},{"endNodeId":"a30","edgeLabel":"g","startNodeId":"p10"},{"endNodeId":"a32","edgeLabel":"g","startNodeId":"p11"},{"endNodeId":"a35","edgeLabel":"g","startNodeId":"p12"}],"nodes":[{"nodeId":"a17","nodeType":"d"},{"nodeId":"p7","nodeType":"i"},{"nodeId":"a3","nodeType":"d"},{"nodeId":"p0","nodeType":"i"},{"nodeId":"p11","nodeType":"i"},{"nodeId":"a35","nodeType":"d"},{"nodeId":"a24","nodeType":"d"},{"nodeId":"a36","nodeType":"d"},{"nodeId":"a9","nodeType":"d"},{"nodeId":"p14","nodeType":"i"},{"nodeId":"a16","nodeType":"d"},{"nodeId":"a10","nodeType":"d"},{"nodeId":"a14","nodeType":"d"},{"nodeId":"a23","nodeType":"d"},{"nodeId":"a22","nodeType":"d"},{"nodeId":"a8","nodeType":"d"},{"nodeId":"a25","nodeType":"d"},{"nodeId":"a37","nodeType":"d"},{"nodeId":"p3","nodeType":"i"},{"nodeId":"a27","nodeType":"d"},{"nodeId":"p10","nodeType":"i"},{"nodeId":"a21","nodeType":"d"},{"nodeId":"p8","nodeType":"i"},{"nodeId":"a34","nodeType":"d"},{"nodeId":"a7","nodeType":"d"},{"nodeId":"a20","nodeType":"d"},{"nodeId":"a1","nodeType":"d"},{"nodeId":"a2","nodeType":"d"},{"nodeId":"a11","nodeType":"d"},{"nodeId":"a29","nodeType":"d"},{"nodeId":"p2","nodeType":"i"},{"nodeId":"a33","nodeType":"d"},{"nodeId":"a18","nodeType":"d"},{"nodeId":"a26","nodeType":"d"},{"nodeId":"p12","nodeType":"i"},{"nodeId":"p9","nodeType":"i"},{"nodeId":"a13","nodeType":"d"},{"nodeId":"a28","nodeType":"d"},{"nodeId":"a30","nodeType":"d"},{"nodeId":"a4","nodeType":"d"},{"nodeId":"p4","nodeType":"i"},{"nodeId":"a31","nodeType":"d"},{"nodeId":"a19","nodeType":"d"},{"nodeId":"p1","nodeType":"i"},{"nodeId":"a15","nodeType":"d"},{"nodeId":"a6","nodeType":"d"},{"nodeId":"a12","nodeType":"d"},{"nodeId":"a0","nodeType":"d"},{"nodeId":"p6","nodeType":"i"},{"nodeId":"a5","nodeType":"d"},{"nodeId":"a32","nodeType":"d"},{"nodeId":"p5","nodeType":"i"},{"nodeId":"p13","nodeType":"i"}]}' ;     
	var traceJSON = Y.JSON.parse(traceJSONStr);
	//var wfContainer = Y.one('#wfContainer');
	var wfContainer = document.getElementById('wfContainer');
	displayTraceJSON(wfContainer, traceJSON);
});

</script>


</body>
</html>
